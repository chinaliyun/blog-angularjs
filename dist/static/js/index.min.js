function isMobile(){var t=navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),n="iphone os"==t.match(/iphone os/i),o="midp"==t.match(/midp/i),i="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),a="ucweb"==t.match(/ucweb/i),l="android"==t.match(/android/i),r="windows ce"==t.match(/windows ce/i),c="windows mobile"==t.match(/windows mobile/i);return!!(e||n||o||i||a||l||r||c)}"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}),window.onload=function(){isMobile()||(document.querySelector("html").className="pc")},function(){angular.module("app",["ngCookies","ui.router"])}(),function(){function t(t,e,e,n){}angular.module("app").controller("adminCtrl",t),t.$inject=["$scope","model","model","dict"]}(),function(){function t(t,e,n,o){function i(){var o={id:e.params.id};n.getArticleDetail(o).then(function(e){e.ok&&(t.id=e.ok.id,t.title=e.ok.title,t.content=e.ok.content,t.labels=e.ok.labels)})}function a(){n.getLabelList().then(function(e){e.ok&&(t.labels=e.ok)})}!function(){t.id="",t.showPreview=!0,t.title="",t.content="",t.labels=[],e.params.id?i():a()}(),t.togglePreview=function(){t.showPreview=!t.showPreview},t.showDetail=function(e){t.content=e.content,t.title=e.title},t.toggleLabel=function(t){t.select=!t.select},t.change=function(){},t.save=function(){var e={id:t.id,title:t.title,content:t.content,labels:[]};t.labels.map(function(t,n){t.select&&e.labels.push({id:t.id,name:t.name})}),n.saveArticle(e).then(function(e){e.ok?t.id||o.go("admin.article",{id:e.ok.id}):alert(e.err.msg)})}}angular.module("app").controller("adminArticleCtrl",t),t.$inject=["$scope","$state","model","dict"]}(),function(){function t(t,e,n){function o(){e.getLabelList().then(function(e){e.ok&&(t.list=e.ok)})}!function(){t.name="",o()}(),t.addLabel=function(){if(""==t.name.trim)return console.log("标签名不能为空"),!1;var n={name:t.name.trim()};e.saveLabel(n).then(function(e){e.ok&&(t.list.push(e.ok[0]),t.name="",document.querySelector(".addLabel").focus())})},t.deleteLabel=function(n,o){var i={id:n.id};e.deleteLabel(i).then(function(e){e.ok&&t.list.splice(o,1)})}}angular.module("app").controller("adminLabelCtrl",t),t.$inject=["$scope","model","dict"]}(),function(){function t(t,e){function n(){e.getArticleList(t.search).then(function(e){if(e.ok){t.list=e.ok.list,t.categoryList=e.ok.category;var n=0;e.ok.category.map(function(t,e){n+=parseInt(t.sum)}),t.labelCount=n;var n=0;e.ok.category.map(function(t,e){n+=parseInt(t.sum),console.log(t)}),t.articleCount=n}})}!function(){t.list=[],t.categoryList=[],t.articleCount=0,n()}()}angular.module("app").controller("adminListCtrl",t),t.$inject=["$scope","model"]}(),function(){function t(t,e){}angular.module("app").controller("homeCtrl",t),t.$inject=["$scope","dict"]}(),function(){function t(t,e,n,o){!function(){t.phone="",t.passwd=""}(),t.login=function(){if(0==t.phone.trim().length)return o.alert(t,"手机号码不能为空"),!1;if(0==t.passwd.trim().length)return o.alert(t,"密码不能为空"),!1;var i={phone:t.phone,passwd:md5(t.passwd)};e.login(i).then(function(e){e.ok?(n.put("phone",e.ok.phone),n.put("usid",e.ok.usid),n.put("token",e.ok.token),o.go("home.list")):o.alert(t,e.err.msg)})}}angular.module("app").controller("homeLoginCtrl",t),t.$inject=["$scope","model","cache","dict"]}(),function(){function t(t,e,n,o){function i(){var o={id:e.params.id};n.getArticleDetail(o).then(function(e){e.ok&&(t.detail=e.ok)})}!function(){e.params.id?i():o.go("home.list")}()}angular.module("app").controller("homeArticleCtrl",t),t.$inject=["$scope","$state","model","dict"]}(),function(){function t(t,e){function n(){e.getArticleList(t.search).then(function(e){if(e.ok){t.list=e.ok.list,t.categoryList=e.ok.category;var n=0;e.ok.category.map(function(t,e){n+=parseInt(t.sum)}),t.labelCount=n}})}!function(){t.search={pageNo:0,type:""},t.labelCount=0,n()}()}angular.module("app").controller("homeListCtrl",t),t.$inject=["$scope","model"]}(),function(){function t(t,e,n){!function(){t.phone="",t.passwd=""}(),t.register=function(){if(0==t.phone.trim().length)return n.alert(t,"手机号码不能为空"),!1;if(0==t.passwd.trim().length)return n.alert(t,"密码不能为空"),!1;if(t.passwd.length<6)return n.alert(t,"密码长度不能少于6位"),!1;if(/^\d{6,11}$/.test(t.passwd)||!/[A-Z]/.test(t.passwd))return n.alert(t,"密码过于简单"),!1;var o={phone:t.phone,passwd:md5(t.passwd)};e.register(o).then(function(e){e.ok?n.go("home.login"):n.alert(t,e.err.msg)})}}angular.module("app").controller("homeRegisterCtrl",t),t.$inject=["$scope","model","dict"]}(),function(){function t(t){function e(t,e,n){}return{link:e,restrict:"EA",templateUrl:"./static/view/app_alert.html"}}angular.module("app").directive("appAlert",t),t.$inject=["$timeout"]}(),function(){function t(t){function e(e){return t.get(e)}function n(e,n){t.put(e,n)}function o(e){t.remove(e)}return{get:e,put:n,remove:o}}angular.module("app").factory("cache",t),t.$inject=["$cookies"]}(),function(){function t(t,e){t.state("home",{url:"/home",templateUrl:"./static/view/home.html",controller:"homeCtrl"}).state("home.login",{url:"/login",templateUrl:"./static/view/home_login.html",controller:"homeLoginCtrl"}).state("home.register",{url:"/register",templateUrl:"./static/view/home_register.html",controller:"homeRegisterCtrl"}).state("home.list",{url:"/list",templateUrl:"./static/view/home_list.html",controller:"homeListCtrl"}).state("home.article",{url:"/article/:id",templateUrl:"./static/view/home_article.html",controller:"homeArticleCtrl"}).state("login",{url:"/login",templateUrl:"./static/view/login.html",controller:"loginCtrl"}).state("admin",{url:"/admin",templateUrl:"./static/view/admin.html"}).state("admin.new",{url:"/new",templateUrl:"./static/view/admin_article.html",controller:"adminArticleCtrl"}).state("admin.article",{url:"/article/:id",templateUrl:"./static/view/admin_article.html",controller:"adminArticleCtrl"}).state("admin.list",{url:"/list",templateUrl:"./static/view/admin_list.html",controller:"adminListCtrl"}).state("admin.label",{url:"/label",templateUrl:"./static/view/admin_label.html",controller:"adminLabelCtrl"}),e.otherwise("/home/list")}angular.module("app").config(t),t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function t(t,e,n){e.$on("$stateChangeSuccess",function(t){})}angular.module("app").run(t),t.$inject=["dict","$rootScope","$state"]}(),function(){function t(t){return function(e){return converter=new showdown.Converter,html=converter.makeHtml(e),t.trustAsHtml(html)}}angular.module("app").filter("html",t),t.$inject=["$sce"]}(),function(){function t(t,e,n,o,i,a){a.httpQueue=[],a.cache={},a.pageSize=["10","20","30"],a.checkToken=function(){var n=e.defer();return t.get("tokenId")?(console.log("token存在"),n.resolve()):(console.log("token不存在"),n.reject()),n.promise},a.go=function(t,e){e?o.go(t,e):o.go(t)},a.alert=function(t,n,o,a,l){t.alertVisiable=!0;var r=e.defer();return t.alertVisiable=!0,t.alertShowBtn=o||!1,t.alertOkText=a||"确定",t.alertCancelText=l||"",t.alertContext=n||"没有可以显示的内容",t.alertOk=function(){t.alertVisiable=!1,t.alertShowBtn=!1,r.resolve()},t.alertCancel=function(){t.alertVisiable=!1,t.alertShowBtn=!1,r.reject()},t.alertShowBtn||i(function(){t.alertOk()},1e3),r.promise},a.loading=function(t){t?($rootScope.loadingText=t,$rootScope.loading=!0):($rootScope.loadingText="",$rootScope.loading=!1)},a.verify={mobile:function(t){return/^1\d{10}$/.test(t)},email:function(t){return/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(t)},url:function(t){return/(https?|ftp|file):\/\/[-A-Za-z0-9+&@#\/%?=~_|!:,.;]+[-A-Za-z0-9+&@#\/%=~_|]/.test(t)}},a.pre={}}angular.module("app").constant("dict",{}).run(t),t.$inject=["cache","$q","http","$state","$timeout","dict"]}(),function(){"use strict";function t(t,e,n,o,i,a){function l(o,a,l,r,c){c&&i.loading(1);var s=e.defer();return t.get(a).then(function(t){c&&n(function(){i.loading()},300),console.log(o+","+a+" Res ",t.data),s.resolve(t.data)},function(t){c&&n(function(){i.loading()},300),console.log(o+","+a+", 请求失败, err: ",t),s.reject(t)}),s.promise}function r(a,l,r,c,s){s&&i.loading(1);var u=e.defer();return t({url:"http://127.0.0.1:8888"+l,method:"POST",headers:{"Content-Type":void 0},transformRequest:function(){var t=new FormData;return angular.forEach(r,function(e,n){angular.isArray(e)?angular.forEach(e,function(e,o){t.append(n,e)}):t.append(n,e)}),t.append("token",o.get("token")),t.append("appid",o.get("appid")),t.append("userId",o.get("userId")),t}}).then(function(t){s&&n(function(){i.loading()},300),101===t.data.code?(i.go("login"),i.clearCache(),u.reject()):(console.log(a+","+l+" Res ",t.data),u.resolve(t.data))},function(t){s&&n(function(){i.loading()},300),console.log(a+","+l+", 请求失败, err: ",t),u.reject(t)}),u.promise}function c(n,a,l,r,c){c&&(i.loading(1),i.listEmpty());var s=e.defer(),u={token:o.get("token"),uid:o.get("userId"),appid:o.get("appid")},d={headers:{"Content-Type":"text/plain"}},p="http://127.0.0.1:8888"+a,m=l?Object.assign({},u,l):u,f=r?Object.assign({},d,r):d;return console.log(n+" Req: ",Object.assign({},{realUrl:p},m)),t.post(p,m,f).then(function(t){if(c&&i.loading(),0!=t.data.code||void 0===t.data.data)return s.resolve({err:{code:t.data.code,msg:t.data.msg}}),console.log({err:{code:t.data.code,msg:t.data.msg}}),!1;console.log(n+" Res: ",t.data),console.log({ok:""==t.data.data||t.data.data}),s.resolve({ok:""==t.data.data||t.data.data})},function(t){c&&i.loading(),console.log(n+" Err: ",t),s.resolve({err:t})}),s.promise}return{get:l,post:c,file:r}}angular.module("app").factory("http",t),t.$inject=["$http","$q","$timeout","cache","dict","$rootScope"]}(),function(){function t(t){this.getArticleList=function(e){return t.post("获取文章列表","/article/article_list",e)},this.saveArticle=function(e){return t.post("保存文章","/article/save",e)},this.getArticleDetail=function(e){return t.post("获取文章详情","/article/get_detail",e)},this.getLabelList=function(e){return t.post("获取标签列表","/constant/all_label",e)},this.saveLabel=function(e){return t.post("保存标签","/constant/add_label",e)},this.deleteLabel=function(e){return t.post("删除标签","/constant/delete_label",e)},this.register=function(e){return t.post("注册账号","/user/register",e)},this.login=function(e){return t.post("用户登录","/user/login",e)}}angular.module("app").service("model",t),t.$inject=["http"]}();